import json

with open("/home/ostesayed/Desktop/Scanners/OSTEscaner/nikto_vulnerability_tunning/nikto_tuning.json", 'r') as nikto_file:
         nikto_vulnerability= json.load(nikto_file)     
test="none"
if test  in nikto_vulnerability['nikto_vulnerability']['sql_injection']['ids']:
     nikto_vulnerability['nikto_vulnerability']['sql_injection']['number']=nikto_vulnerability['nikto_vulnerability']['sql_injection']['number']
name="niktoreport"
def get_nikto_vulnerability(name):
    global nikto_vulnerability
    with open("{}.json".format(name), 'r') as nikto_report_file:
         nikto_report_vulnerability= json.load(nikto_report_file)
         
         for i in range(len(nikto_report_vulnerability['vulnerabilities'])):
              print(nikto_report_vulnerability['vulnerabilities'][i]['id'])
              if nikto_report_vulnerability['vulnerabilities'][i]['id']  in nikto_vulnerability['nikto_vulnerability']['sql_injection']['ids']:
                        nikto_vulnerability['nikto_vulnerability']['sql_injection']['number']=nikto_vulnerability['nikto_vulnerability']['sql_injection']['number']+1
              elif nikto_report_vulnerability['vulnerabilities'][i]['id']  in nikto_vulnerability['nikto_vulnerability']['XML injection']['ids']:
                        nikto_vulnerability['nikto_vulnerability']['XML injection']['number']=nikto_vulnerability['nikto_vulnerability']['XML injection']['number']+1

              elif nikto_report_vulnerability['vulnerabilities'][i]['id']  in nikto_vulnerability['nikto_vulnerability']['script_injection']['ids']:
                        nikto_vulnerability['nikto_vulnerability']['script_injection']['number']=nikto_vulnerability['nikto_vulnerability']['script_injection']['number']+1
              elif nikto_report_vulnerability['vulnerabilities'][i]['id']  in nikto_vulnerability['nikto_vulnerability']['sql information']['ids']:
                        nikto_vulnerability['nikto_vulnerability']['sql information']['number']=nikto_vulnerability['nikto_vulnerability']['sql information']['number']+1
              elif nikto_report_vulnerability['vulnerabilities'][i]['id']  in nikto_vulnerability['nikto_vulnerability']['html injection']['ids']:
                        nikto_vulnerability['nikto_vulnerability']['html injection']['number']=nikto_vulnerability['nikto_vulnerability']['html injection']['number']+1
              elif nikto_report_vulnerability['vulnerabilities'][i]['id']  in nikto_vulnerability['nikto_vulnerability']['XSLT_Extensible Stylesheet Language Transformations injection']['ids']:
                        nikto_vulnerability['nikto_vulnerability']['XSLT_Extensible Stylesheet Language Transformations injection']['number']=nikto_vulnerability['nikto_vulnerability']['XSLT_Extensible Stylesheet Language Transformations injection']['number']+1
              elif nikto_report_vulnerability['vulnerabilities'][i]['id']  in nikto_vulnerability['nikto_vulnerability']['remote source injection']['ids']:
                        nikto_vulnerability['nikto_vulnerability']['remote source injection']['number']=nikto_vulnerability['nikto_vulnerability']['remote source injection']['number']+1
              elif nikto_report_vulnerability['vulnerabilities'][i]['id']  in nikto_vulnerability['nikto_vulnerability']['XSS injection']['ids']:
                        nikto_vulnerability['nikto_vulnerability']['XSS injection']['number']=nikto_vulnerability['nikto_vulnerability']['XSS injection']['number']+1
get_nikto_vulnerability("/home/ostesayed/Desktop/Scanners/OSTEscaner/Resaults/JucyShope2/nikto/JucyShope2_9")         
get_nikto_vulnerability("/home/ostesayed/Desktop/Scanners/OSTEscaner/Resaults/JucyShope2/nikto/JucyShope2_4")
get_nikto_vulnerability("/home/ostesayed/Desktop/Scanners/OSTEscaner/Resaults/JucyShope2/nikto/JucyShope2_f")


# nikto -h http://localhost:3000//rest/product/search?q=  -o /home/ostesayed/Desktop/Scanners/OSTEscaner/Resaults/JucyShope2/nikto/JucyShope2_f.json -F json -Tuning 4
                        
print("this is the number of sql injection possiiblity:",nikto_vulnerability['nikto_vulnerability']['sql_injection']['number'])

print("this is the number of XML injection possiiblity:",nikto_vulnerability['nikto_vulnerability']['XML injection']['number'])

print("this is the number of script_injection possiiblity:",nikto_vulnerability['nikto_vulnerability']['script_injection']['number'])

print("this is the number of sql information possiiblity:",nikto_vulnerability['nikto_vulnerability']['sql information']['number'])

print("this is the number of html injection possiiblity:",nikto_vulnerability['nikto_vulnerability']['html injection']['number'])

print("this is the number of XSLT_Extensible Stylesheet Language Transformations injection possiiblity:",nikto_vulnerability['nikto_vulnerability']['XSLT_Extensible Stylesheet Language Transformations injection']['number'])

print("this is the number of remote source injection possiiblity:",nikto_vulnerability['nikto_vulnerability']['remote source injection']['number'])

print("this is the number of XSS injection possiiblity:",nikto_vulnerability['nikto_vulnerability']['XSS injection']['number'])

